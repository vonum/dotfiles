set nocompatible              " be iMproved, required
filetype off                  " required

" set the runtime path to include Vundle and initialize
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

" let Vundle manage Vundle, required
Plugin 'gmarik/Vundle.vim'

Plugin 'vim-airline/vim-airline'
Plugin 'ervandew/supertab'
Plugin 'mileszs/ack.vim'
Plugin 'renderedtext/vim-bdd'
Plugin 'godlygeek/tabular'
Plugin 'plasticboy/vim-markdown'
Plugin 'tpope/vim-projectionist'
Plugin 'tpope/vim-rails'
Plugin 'tpope/vim-rake'
Plugin 'tpope/vim-cucumber'
Plugin 'tpope/vim-fugitive'
Plugin 'tpope/vim-surround'
Plugin 'tpope/vim-endwise'
Plugin 'tpope/vim-repeat'
Plugin 'tpope/vim-commentary'
Plugin 'thisivan/vim-bufexplorer'
Plugin 'gregsexton/MatchTag'
Plugin 'kien/ctrlp.vim'
Plugin 'elixir-lang/vim-elixir'
Plugin 'renderedtext/vim-elixir-alternative-files'
Plugin 'bogado/file-line'
Plugin 'pangloss/vim-javascript'
Plugin 'mxw/vim-jsx'

" All of your Plugins must be added before the following line
call vundle#end()            " required
filetype plugin indent on    " required

" **************************************************************"
" MAPPINGS
" **************************************************************"

" Define space as map leader (' ')
let mapleader = " "

" Treat long lines as separate lines
map j gj
map k gk

" Easier navigation between split windows CTRL + { h, j, k, l }
nnoremap <c-j> <c-w>j
nnoremap <c-k> <c-w>k
nnoremap <c-h> <c-w>h
nnoremap <c-l> <c-w>l

" Disable cursor keys in normal mode
map <Left>  :echo "no! use h!"<CR>
map <Down>  :echo "no! use j!"<CR>
map <Up>    :echo "no! use k!"<CR>
map <Right> :echo "no! use l!"<CR>

" Faster saving and exiting
nnoremap <silent><leader>q :q!<CR>
nnoremap <silent><leader>w :w!<CR>
nnoremap <silent><leader>x :x<CR>
nnoremap <silent><leader>Q :qa!<CR>
nnoremap <silent><leader>W :wa!<CR>
nnoremap <silent><leader>X :xa<CR>
nnoremap <silent><leader>1 :source ~/.vimrc \| :PluginInstall<CR>

" Extra <CR> is for disabling /"Press ENTER or type command to continue/"
nnoremap <silent><leader>e :Exp<CR><CR>

" Switch to alternate file
nnoremap <leader><leader> <c-^>
" Open Buffer
nnoremap <silent><leader>l :BufExplorer<CR>
" Open test file for the current file
nnoremap <silent><leader>s :A<CR>
" Open test file for the current file in a vertical window
nnoremap <silent><leader>S :AV<CR>
" Open test file for elixir
nnoremap <silent><leader>t :call ElixirAlternateFile()<CR>

" Splits
nnoremap <silent><leader>v :vs<CR>
nnoremap <silent><leader>h :split<CR>

" Paste mode
nnoremap <F1> :set invpaste paste?<CR>
set pastetoggle=<F1>
set showmode

" Indent visual selected code without unselecting
vmap > >gv
vmap < <gv
vmap = =gv

" Clear search highlighting
nnoremap <silent><leader><CR> :nohl<CR>

" **************************************************************"
" CONFIG
" **************************************************************"

" Delete empty space from the end of lines on every save
autocmd BufWritePre * :%s/\s\+$//e

" set up default path
exe "set path=".expand("$PATH")

set title
set nomodeline

" enable syntax highlighting
syntax enable
set background=dark

" sync clipboards
set clipboard=unnamedplus

" Hide annoying E37: No write since last change (add ! to override)
set hidden

" Show line numbers
set number
set numberwidth=4
set ruler

" Formatting Options
set wrap      " Soft Wrap in all files
set linebreak " Maintains the whole words when wrapping

" Indentation
set autoindent
set cindent
set smartindent

" Tab Options
set shiftwidth=2
set tabstop=2
set softtabstop=2
set expandtab

" Always show the statusline
set laststatus=2

" Sane search options
set hlsearch   " Highlight search
set incsearch  " Incremental search
set magic      " Set magic on, for regular expressions
set ignorecase " Searches are Non Case-sensitive
set smartcase


" Sane folding defaults, use zf to fold and zd to unfold
set foldenable
set foldmethod=marker
set foldlevel=0
set foldcolumn=0

" Improves redrawing for newer computers
set ttyfast
set lazyredraw         " The screen won't be redrawn unless actions took place

set showmatch          " Shows matching brackets when text indicator is over them
set scrolloff=5        " Show 5 lines of context around the cursor
set sidescrolloff=20
set scrolljump=10

set showcmd
set diffopt+=context:3

" Disable backups and swap files
set nobackup
set nowritebackup
set noswapfile

" Disable all bells and whistles
set noerrorbells visualbell t_vb=

" Wild menu (Autocompletion)"
set wildmenu
set wildignore=.svn,CVS,.git,*.o,*.a,*.class,*.mo,*.la,*.so,*.obj,*.swp,*.jpg,*.jpeg,*.png,*.xpm,*.gif
set wildmode=full

" Backspace will delete EOL chars, as well as indents
set backspace=indent,eol,start

" For characters that forms pairs for using % commands, this is for HTML Tags
set matchpairs+=<:>

" To avoid the 'Hit Enter' prompts caused by the file messages
set shortmess=atToOI

if !has('nvim')
  " Set default encoding to utf-8
  set encoding=utf-8
  set termencoding=utf-8
endif

" set correct filetypes for various languages
au BufRead,BufNewFile *.cap setlocal filetype=ruby
au BufRead,BufNewFile Capfile* setlocal filetype=ruby
au BufRead,BufNewFile *.md setlocal textwidth=80
au BufRead,BufNewFile *.md setlocal colorcolumn=+1

au BufRead,BufNewFile *.feature setlocal spell

" Instantly leave insert mode when pressing <ESC>
" This works by disabling the mapping timeout completely in normal
" mode, and enabling it in insert mode with a very low timeout length.
augroup fastescape
  autocmd!

  set notimeout
  set ttimeout
  set timeoutlen=10

  au InsertEnter * set timeout
  au InsertLeave * set notimeout
augroup END

" **************************************************************"
" PLUGIN CONFIG
" **************************************************************"

" Autocompletion settings
let g:SuperTabDefaultCompletionType = "<c-n>"

" markdown configuration
let g:vim_markdown_folding_disabled = 1

" CTRL P
let g:ctrlp_custom_ignore = '\v[\/]\.(git|hg|svn)|deps|_build|vendor$'

" Ack vim
let g:ackprg="ack-grep -H --nocolor --nogroup --column --ignore-dir={vendor,.git}"

" Search word under cursor
" nnoremap F :Ack "\b<cword>\b" app lib spec features config<CR>

" Disable AutoComplPop.
let g:acp_enableAtStartup = 0

" Enable JSX syntax highlight in .js files
let g:jsx_ext_required = 0

" Tree view depth
let g:netrw_liststyle = 3

" Fugitive colors
set filetype=fugitiveblame
